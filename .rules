# Правила для ИИ-ассистентов
# Этот файл содержит правила и настройки для ИИ-ассистентов, работающих с проектом

rules:
  # !CRITICAL: Самое важное правило - фокус на запрашиваемой функциональности
  focus:
    priority: "critical"
    description: |
      При выполнении запросов строго придерживаться фокуса на запрашиваемой функциональности:
      
      ✅ ДЕЛАТЬ:
      - Реализовывать точно то, что запрошено
      - Добавлять недостающие функциональные элементы, если они критически необходимы
        (например, создать отсутствующий файл страницы при реализации её сборщика)
      - Исправлять явные функциональные ошибки

      ❌ НЕ ДЕЛАТЬ:
      - Добавлять декоративные элементы (цвета, фоны, отступы)
      - Реализовывать дополнительные "улучшения", не связанные с запросом
      - Менять существующий дизайн без явного запроса

      Любые сомнения трактовать в сторону минимального вмешательства.

  language:
    primary: "russian"  # Основной язык для общения и документации
    description: |
      Все взаимодействие с пользователем, включая:
      - Комментарии в коде
      - Документацию
      - Сообщения коммитов
      - Ответы и объяснения
      должно происходить на русском языке.
    
    exceptions:
      - Технические термины могут использоваться на английском
      - Названия переменных, функций и классов остаются на английском
      - Команды Git и других инструментов используются как есть

  commits:
    execution:
      trigger: "manual"  # Коммиты выполняются только по явному запросу пользователя
      description: |
        Коммиты не должны создаваться автоматически после каждого изменения.
        Создание коммита происходит только после явного запроса пользователя.
    
    message_generation:
      process:
        - Получить состояние файлов из последнего коммита
        - Сравнить с текущим состоянием изменённых файлов
        - Проанализировать разницу между версиями
        - Сформировать осмысленное описание внесённых изменений
      
      requirements:
        - Сообщение должно отражать реальные изменения в коде
        - Описание должно быть кратким, но информативным
        - Формат сообщения следует правилам conventional commits
        - Текст сообщения на русском языке
        - При работе над задачей добавлять ссылку на неё:
          - fixes #123 - если коммит полностью решает задачу
          - refs #123  - если коммит частично решает задачу

  special_commands:
    commit_message:
      trigger: "§"
      description: |
        Если сообщение пользователя начинается с символа §, 
        необходимо проанализировать изменения с момента последнего коммита
        и подготовить комментарий для нового коммита, но сам коммит не выполнять.
      
      response:
        - Показать подготовленный комментарий пользователю
        - Дождаться подтверждения или корректировки текста
        - Не выполнять коммит автоматически

    server:
      restart:
        description: |
          Перезагрузка сервера предлагается только при изменениях в серверной части проекта:
          - Изменения в директории cmd/
          - Изменения конфигурационных файлов сервера
          - Изменения роутинга или обработчиков

        excluded_changes:
          - Изменения в статических файлах (static/)
          - Изменения стилей и скриптов
          - Изменения HTML-шаблонов
          - Изменения документации